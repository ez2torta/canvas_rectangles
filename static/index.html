<!DOCTYPE html>
<html>

<head>
    <script>
        // Ejemplo implementando el metodo POST:
        async function getData(url = '') {
            // Opciones por defecto estan marcadas con un *
            const response = await fetch(url, {
                method: 'GET', // *GET, POST, PUT, DELETE, etc.
                mode: 'cors', // no-cors, *cors, same-origin
                cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
                credentials: 'same-origin', // include, *same-origin, omit
                headers: {
                    'Content-Type': 'application/json'
                    // 'Content-Type': 'application/x-www-form-urlencoded',
                },
                redirect: 'follow', // manual, *follow, error
                referrerPolicy: 'no-referrer', // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url
            });
            return response.json(); // parses JSON response into native JavaScript objects
        }
        const getRectangleSolution = async (mainWidth, mainHeight, rectWidth, rectHeight) => {
            return await getData(`http://0.0.0.0:8000/rectangle_problem/${mainWidth}/${mainHeight}/${rectWidth}/${rectHeight}`)
        }
        const _ZOOM_FACTOR = 80
        let rectangleList = []
        function drawMainRectangle(ctx, width, height) {
            // draws the main rectangle given the width and height
            ctx.beginPath();
            ctx.lineWidth = "2";
            ctx.strokeStyle = "gray";
            ctx.rect(0, 0, width * _ZOOM_FACTOR, height * _ZOOM_FACTOR);
            ctx.stroke();
        }

        function fillRectangle(ctx, x, y, width, height) {
            ctx.beginPath();
            ctx.lineWidth = "1";
            ctx.strokeStyle = "lightgray";
            ctx.rect(x * _ZOOM_FACTOR, y * _ZOOM_FACTOR, width * _ZOOM_FACTOR, height * _ZOOM_FACTOR);
            ctx.stroke();
        }
        function fillCanvas() {
            const canvas = document.getElementById("canvas");
            const ctx = canvas.getContext("2d");
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const mainWidth = document.getElementById("main_width").value;
            const mainHeight = document.getElementById("main_height").value;
            const rectWidth = document.getElementById("rect_width").value;
            const rectHeight = document.getElementById("rect_height").value;
            drawMainRectangle(ctx, mainWidth, mainHeight);
            getRectangleSolution(mainWidth, mainHeight, rectWidth, rectHeight)
                .then(rectangleList => {
                    console.log(rectangleList); // JSON data parsed by `data.json()` call
                    rectangleList.forEach(item => {
                        fillRectangle(ctx, item.position.x, item.position.y, item.width, item.height);
                    })
                });
        }

    </script>
</head>

<body>
    <h4>
        <label for="main_width">Main Width</label>
        <input id="main_width" name="main_width" type="number" value="3" min="0" max="10" />
    </h4>
    <h4>
        <label for="main_height">Main Height</label>
        <input id="main_height" name="main_height" type="number" value="5" min="0" max="10" />
    </h4>

    <h4>
        <label for="rect_width">Rect Width</label>
        <input id="rect_width" name="rect_width" type="number" value="2" min="0" max="10" />
    </h4>
    <h4>
        <label for="rect_height">Rect Width</label>
        <input id="rect_height" name="rect_height" type="number" value="1" min="0" max="10" />
    </h4>
    <h4>
        <button type="submit" onclick="fillCanvas()">Llenar Canvas!</button>
    </h4>
    <canvas id="canvas" width="640" height="480">No Canvas?</canvas>

</body>

</html>